replicaCount: 1

image:
  repository: x-pass
  pullPolicy: IfNotPresent
  # Overrides the image tag whose default is the chart appVersion.
  tag: ""

imagePullSecrets: []
nameOverride: ""
fullnameOverride: ""

serviceAccount:
  create: true
  annotations: {}
  # The name of the service account to use.
  # If not set and create is true, a name is generated using the fullname template.
  name: ""

podAnnotations: {}

podSecurityContext:
  runAsNonRoot: true
  runAsUser: 65534
  fsGroup: 65534

securityContext:
  allowPrivilegeEscalation: false
  readOnlyRootFilesystem: true
  capabilities:
    drop:
      - ALL

service:
  type: ClusterIP
  port: 8080

ingress:
  enabled: false
  className: ""
  annotations: {}
  hosts:
    - host: x-pass.example.local
      paths:
        - path: /
          pathType: Prefix
  tls: []

# -- Keycloak OIDC connection settings
keycloak:
  # -- Realm issuer URL (e.g. https://keycloak.example.com/realms/myrealm)
  issuerURL: ""
  # -- Expected JWT audience (optional)
  audience: ""
  # -- Broker's Keycloak client ID
  clientID: ""
  # -- Keycloak realm name
  realm: ""

# -- Vault connection settings (OIDC auth â€” Vault CLI-style localhost flow)
vault:
  # -- Vault server address (e.g. https://vault.example.com)
  addr: ""
  # -- Vault OIDC auth mount path
  oidcMount: "oidc"
  # -- Vault OIDC auth role name
  oidcRole: "wyrd-x-pass"
  # -- KV v2 mount path used by the broker to read secrets
  kvMount: "secret"
  # -- Default wrap TTL for response-wrapped secret reads
  wrapTTL: "300s"

# -- Localhost OIDC callback listener (Vault CLI-style flow).
# The broker starts a temporary HTTP server on this address to capture
# the OIDC redirect.  No public callback endpoint is needed.
# IMPORTANT: The Vault OIDC role and Keycloak client must both include
# the redirectURI in their allowed redirect URIs.
oidcCallback:
  # -- Listen address for the temporary callback server
  listenHost: "127.0.0.1"
  # -- Listen port for the temporary callback server
  listenPort: 8250
  # -- Full redirect URI passed to Vault OIDC auth_url request
  redirectURI: "http://localhost:8250/oidc/callback"

# -- Name of an existing Secret containing sensitive env vars.
# Must contain keys: KEYCLOAK_CLIENT_SECRET, WRAPTOKEN_ENC_KEY, KEYCLOAK_USERNAME, KEYCLOAK_PASSWORD
existingSecret: ""

# -- Headless OIDC login timing
login:
  # -- Keycloak login page timeout
  loginTimeout: "2m"
  # -- Duo push approval timeout
  duoTimeout: "5m"

# -- Playwright browser settings
playwright:
  # -- Run browser in headless mode
  headless: "true"
  # -- Browser engine (chromium)
  browser: "chromium"

# -- Service registry YAML mounted into the pod.
# Defines which services the broker can mediate and their Vault/Keycloak mappings.
# See config.example.yaml for the full schema.
serviceRegistry:
  # payroll-db:
  #   vault:
  #     kv2_mount: "secret"
  #     kv2_path: "prod/payroll/db"
  #   authz:
  #     keycloak:
  #       resource_id: "vault:payroll-db"
  #       scope: "read"
  #   wrap:
  #     max_ttl: "10m"
  #     default_ttl: "5m"

resources: {}
  # limits:
  #   cpu: 100m
  #   memory: 128Mi
  # requests:
  #   cpu: 50m
  #   memory: 64Mi

autoscaling:
  enabled: false
  minReplicas: 1
  maxReplicas: 10
  targetCPUUtilizationPercentage: 80

nodeSelector: {}

tolerations: []

affinity: {}
